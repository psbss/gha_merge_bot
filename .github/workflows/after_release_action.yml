name: After release action

on:
  # check_suite:
  #   types: [completed]
  pull_request:
    types: [opened, reopened, synchronize]

jobs:
  pull_request:
    name: checkout
    runs-on: ubuntu-latest
    if: contains(github.head_ref, 'release/v')
    steps:
      - name: comment check
        id: comment_check
        uses: actions/github-script@d7906e4ad0b1822421a7e6a35d5ca353c962f410 #v6.4.1
        with:
          script: |
            const response = await github.rest.issues.listComments({
              owner: context.repo.owner,
              repo: context.repo.repo,
              issue_number: context.issue.number
            })
            console.log(response)
            const comment = response.data.find((comment) => comment.user.login === 'github-actions[bot]')
            const commentId = comment.id
            console.log(commentId)
            return commentId
          result-encoding: string

      - name: comment delete
        if: steps.comment_check.outputs.result != ''
        uses: actions/github-script@d7906e4ad0b1822421a7e6a35d5ca353c962f410 #v6.4.1
        env:
          COMMENT_ID: "${{ steps.comment_check.outputs.result }}"
        with:
          script: |
            const env = process.env
            github.rest.issues.deleteComment({
              owner: context.repo.owner,
              repo: context.repo.repo,
              comment_id: env.COMMENT_ID
            })

      # - name: comment delete
      #   uses: actions/github-script@d7906e4ad0b1822421a7e6a35d5ca353c962f410 #v6.4.1
      #   with:
      #     script: |
      #       console.log($COMMENT_ID)
      # - name: comment
      #   uses: actions/github-script@d7906e4ad0b1822421a7e6a35d5ca353c962f410 #v6.4.1
      #   env:
      #     MESSAGE: |
      #       If you merge this PR into develop
      #       Please reaction 'ðŸš€' stamp for this comment
      #   with:
      #     script: |
      #       github.rest.issues.createComment({
      #         issue_number: context.issue.number,
      #         owner: context.repo.owner,
      #         repo: context.repo.repo,
      #         body: process.env.MESSAGE
      #       })
      # - uses: actions/checkout@8e5e7e5ab8b370d6c329ec480221332ada57f0ab #v3.5.2
      #   with:
      #     fetch-depth: 0
      #     ref: develop

